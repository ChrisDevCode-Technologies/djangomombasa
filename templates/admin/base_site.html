{% extends "admin/base.html" %}
{% load static %}

{% block title %}{% if subtitle %}{{ subtitle }} | {% endif %}{{ title }} | Django Mombasa Admin{% endblock %}

{% block extrastyle %}
    <link rel="stylesheet" href="{% static 'css/admin.css' %}">
    <script>
    // Override Django's 3-way theme cycle with a 2-way light/dark toggle.
    // Runs before DOMContentLoaded to prevent flash.
    (function() {
        var stored = localStorage.getItem("theme");
        // Convert "auto" or missing value to a concrete theme
        if (stored !== "light" && stored !== "dark") {
            stored = "light";
            localStorage.setItem("theme", stored);
        }
        document.documentElement.dataset.theme = stored;

        document.addEventListener("DOMContentLoaded", function() {
            var buttons = document.querySelectorAll(".theme-toggle");
            buttons.forEach(function(btn) {
                // Remove Django's default click listeners by cloning
                var clone = btn.cloneNode(true);
                btn.parentNode.replaceChild(clone, btn);
                clone.addEventListener("click", function() {
                    var current = localStorage.getItem("theme") || "light";
                    var next = current === "light" ? "dark" : "light";
                    document.documentElement.dataset.theme = next;
                    localStorage.setItem("theme", next);
                });
            });
        });
    })();
    </script>
{% endblock %}

{% block branding %}
    <h1 id="site-name">
        <a href="{% url 'admin:index' %}">
            <img src="{% static 'images/logo.jpg' %}" alt="Django Mombasa" class="admin-logo">
            Django Mombasa
        </a>
    </h1>
{% endblock %}

{% block nav-global %}{% endblock %}
